<button [routerLink]="['/contracts']" class="back-btn d-flex align-items-center justify-content-center mb-5"><i class="fa-solid fa-arrow-left me-3 mt-1"></i>رجوع</button>
<mat-stepper class="mt-5" linear #stepper dir="rtl">
  <mat-step [stepControl]="firstFormGroup" [editable]=true>
    <form class="mt-5" [formGroup]="firstFormGroup">
      <ng-template matStepLabel>الكود وحالة العقد</ng-template>

        <div class="grid-container">

          <div>
            <mat-label class="label">كود التشغيل</mat-label>
            <mat-form-field style="width: 100%;" appearance="outline">
              <input  style="padding: 5px;" formControlName="store_code"  (change)="checkCode()" required="true" dir="rtl" type="number" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" #input  maxlength="6" matInput>
            </mat-form-field>

            <div *ngIf="errorStoreCodeFlag">
              <p class="text-danger">* هذا الكود يوجد بالفعل، يرجى المراجعة</p>
            </div>
          </div>
          <div>
            <mat-label class="label">الساب</mat-label>
            <mat-form-field style="width: 100%;"  id="SAP" appearance="outline">

              <input  style="padding: 5px;" formControlName="sap_code" dir="rtl"  type="text" #SAP  maxlength="8" matInput>
            </mat-form-field>
          </div>
            <div>
              <mat-label class="label">الحالة</mat-label>
            <mat-form-field style="width: fit-content; padding: 10px;" appearance="outline">

            <mat-select style="padding: 7px;" formControlName="status" (selectionChange)="setClass($event.value)" required dir="rtl" placeholder="الحالة" disableOptionCentering panelClass="myPanelClass">
                <mat-option style="background-color: white; padding: 10px;" *ngFor="let state of constants.states" [value]="state.name">
                    {{ state.name }}
                </mat-option>

            </mat-select>
          </mat-form-field>
            </div>

        </div>


    </form>
    <div style="display: flex; align-items: center; justify-content: center; margin-top: 30px;">
      <button mat-raised-button class="m-auto" color="primary" [disabled]="errorStoreCodeFlag"  class="next-button" mat-button matStepperNext>التالي</button>
    </div>

  </mat-step>
  <mat-step  [stepControl]="secondFormGroup" [editable]=true>
      <form class="mt-5"[formGroup]="secondFormGroup">
      <ng-template matStepLabel>معلومات الفرع</ng-template>
      <div class="grid-container">
        <div style="grid-column: 1/2;">
          <mat-label style="padding-left: 28px;" >الاسم</mat-label>
      <mat-form-field  appearance="outline">

        <input style="padding: 5px; width: 200px;" formControlName="branch_name" dir="rtl" #branch  maxlength="150" matInput>
      </mat-form-field>
        </div>
        <div style="grid-column: 2/2;">
          <mat-label style="padding-left: 10px;" >العنوان</mat-label>
      <mat-form-field  id="address" appearance="outline">

        <input style="padding: 5px; width:200px;"  formControlName="branch_address" required="true" dir="rtl" type="text"  #address  maxlength="150" matInput required="true">
      </mat-form-field>
        </div>
        <div>
          <mat-label  style="padding-left: 10px;">المحافظة</mat-label>
      <mat-form-field style="width: 200px;" appearance="outline">

        <mat-select  style="padding: 5px;" required="true" formControlName="governorate" dir="rtl" class="ms-auto"  required="true" disableOptionCentering panelClass="myPanelClass">
            <mat-option  style="padding: 5px; background-color: white;" *ngFor="let gov of constants.governorates"  [value]="gov">
                {{ gov }}
            </mat-option>
      </mat-select>
      </mat-form-field>
        </div>
       <div>
        <mat-label  style="padding-left: 17px;">الإقليم</mat-label>
        <mat-form-field style="width: 200px;" appearance="outline">

        <mat-select  style="padding: 5px;" formControlName="province" required="true" dir="rtl" required="true" disableOptionCentering panelClass="myPanelClass">
            <mat-option style="padding: 5px; background-color: white;"  *ngFor="let area of constants.areas" [value]="area">
                {{ area }}
            </mat-option>
        </mat-select>
        </mat-form-field>
       </div>

    </div>
      </form>
      <div style="display: flex; align-items: center; justify-content: center; margin-top: 30px;">
        <button mat-raised-button class="back-button" style="margin-left: 20px;" mat-button matStepperPrevious>السابق</button>
      <button mat-raised-button class="next-button" mat-button matStepperNext>التالي</button>
    </div>
  </mat-step>
  <mat-step [stepControl]="thirdFormGroup" [editable]=true>
    <ng-template matStepLabel>التواريخ</ng-template>
    <form class="mt-5" [formGroup]="thirdFormGroup">
      <div class="grid-container">

        <div style="grid-column: 1/2;">
          <mat-label style="padding-left: 5px;">السريان</mat-label>
          <mat-form-field appearance="outline">
            <input dir="rtl" formControlName="valid_through"  (dateInput)="transformDate($event.value, 'السريان')" matInput [matDatepicker]="active"  required readonly (focus)="active.open()"placeholder="السريان" required="true">
            <mat-datepicker-toggle matSuffix [for]="active"></mat-datepicker-toggle>
            <mat-datepicker #active></mat-datepicker>
            <mat-hint align="end">يوم/شهر/سنة</mat-hint>
          </mat-form-field>
        </div>
        <div style="grid-column: 2/2;">
          <mat-label style="padding-left: 5px;">الانتهاء</mat-label>
          <mat-form-field appearance="outline">

            <input dir="rtl" formControlName="end_date" (dateInput)="transformDate($event.value, 'الانتهاء')"  matInput [matDatepicker]="end" readonly (focus)="end.open()" placeholder="الانتهاء">
            <mat-datepicker-toggle matSuffix [for]="end"></mat-datepicker-toggle>
            <mat-datepicker #end></mat-datepicker>
            <mat-hint align="end">يوم/شهر/سنة</mat-hint>
          </mat-form-field>
        </div>
        <div style="grid-column: 1/2;">
          <mat-label style="padding-left: 5px;">الاستلام</mat-label>
          <mat-form-field appearance="outline">

            <input dir="rtl" formControlName="receiving_date"  matInput [matDatepicker]="received" (dateInput)="transformDate($event.value, 'الاستلام')"  readonly (focus)="received.open()" placeholder="الاستلام">
            <mat-datepicker-toggle matSuffix [for]="received"></mat-datepicker-toggle>
            <mat-datepicker #received></mat-datepicker>
            <mat-hint align="end">يوم/شهر/سنة</mat-hint>
          </mat-form-field>
        </div>
        <div style="grid-column: 2/2;">
          <mat-label style="padding-left: 5px;" >الافتتاح</mat-label>
          <mat-form-field appearance="outline">

            <input dir="rtl" formControlName="opening_date"   matInput [matDatepicker]="beginning" (dateInput)="transformDate($event.value, 'الافتتاح')"  readonly (focus)="beginning.open()" placeholder="الافتتاح">
            <mat-datepicker-toggle matSuffix [for]="beginning"></mat-datepicker-toggle>
            <mat-datepicker #beginning  ></mat-datepicker>
            <mat-hint align="end">يوم/شهر/سنة</mat-hint>
          </mat-form-field>
        </div>

        <div style="grid-column: 1/2;">
          <mat-label style="padding-left: 5px;">التجديد</mat-label>
          <mat-form-field appearance="outline" style="grid-column: 1;">

            <input dir="rtl" formControlName="renewal_date"   matInput readonly [matDatepicker]="renewal" (dateInput)="transformDate($event.value, 'التجديد')"  (focus)="renewal.open()" placeholder="التجديد">
            <mat-datepicker-toggle matSuffix [for]="renewal"></mat-datepicker-toggle>
            <mat-datepicker #renewal></mat-datepicker>
            <mat-hint align="end">يوم/شهر/سنة</mat-hint>
          </mat-form-field>
        </div>
      </div>
      <div style="display: flex; align-items: center; justify-content: center; margin-top: 30px;">
        <button mat-raised-button class="back-button" style="margin-left: 20px;" mat-button matStepperPrevious>السابق</button>
        <button mat-raised-button class="next-button" mat-button matStepperNext>التالي</button>
      </div>
    </form>
  </mat-step>
  <mat-step [stepControl]="fourthFormGroup" [editable]=true>
    <form class="mt-5" [formGroup]="fourthFormGroup">
      <ng-template matStepLabel>رفع الملفات</ng-template>
      <app-upload #upload></app-upload>
    </form>
    <div style="display: flex; align-items: center; justify-content: center; margin-top: 30px;">
      <button mat-raised-button class="back-button" style="margin-left: 20px;" mat-button matStepperPrevious>السابق</button>
      <button (click)="finish(upload.filesSelected)" mat-raised-button class="next-button" mat-button>إنهاء</button>
    </div>

  </mat-step>

</mat-stepper>





